# helm chart eventhub-backend

Используется для деплоя бекенда в kubernetes.

## Содержимое

```
resources/
    config.yaml.tpl     # шаблон для конфигурационного файла application.yaml
templates/              # шаблоны манифестов для kubernetes
    deployment.yaml     # шаблон для деплоймента приложения, здесь описываются задаются ENV переменные
Chart.yaml              # базовая информация о helm chart
postgres.values.yaml    # значения для шаблонов стороннего postgres helm charta
values.yaml             # значения для шаблонов eventhub-backend 
```

## Как добавить поля в application.yaml для приложения в кубе

1. Ответьте на вопросы:
   1. Будут ли меняться эти поля в зависимости от окружения? 
   2. Содержат ли они секреты?
   3. Использется ли значение поля в нескольких местах?
2. Если на все вопросы дан отрицательный ответ:
   1. Зайдите в `resources/config.yaml.tpl` и пропишите там желаемые поля. Пример:
   ```yaml
   spring:
     application:
       name: eventhub-backend
   ```
3. Если на хотя бы один вопрос ответили да:
   1. Прописываем в `values.yaml` желаемую иерархию полей. Пример: TODO
   2. В шаблон конфига `resources/config.yaml.tpl` прописываем желаемую иерархию полей, значения полей задаём через {{ .Values }}. Пример: TODO
   3. Используя команду `helm template` проверяем, что шаблоны рендерятся ожидаемым образом